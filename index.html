<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<style>
		body {
			background: #000;
		}
		#viewport .loader {
			text-align: center;
			color: red;
			font-family: "Impact";
		}
		#touchKeys, #viewport .gameover {
			display: none;
			position: absolute;
			left: 0;
			right: 0;
			position: absolute;
		}
		#touchKeys {
			bottom: 0;
			font-size: 8em;
			color: rgba(255, 0, 0, 0.2);
		}
		#viewport .gameover {
			text-align: center;
			z-index: 1;
			color: red;
		}
		#viewport canvas {
			margin: auto;
			image-rendering: -moz-crisp-edges;
			image-rendering: pixelated;
		}
		#touchKeys .block {
			position: absolute;
			bottom: 0;
		}
		#touchKeys .left {
			left: 0;
		}
		#touchKeys .right {
			right: 0;
		}
		#touchKeys .block > * {
			width: 1em;
			text-align: center;
		}
		#touchKeys .block > .active {
			background-color: rgba(128, 128, 128, .5);
		}
	</style>
	<script src="jspm_packages/system.js"></script>
	<script src="config.js"></script>
	<script>
		System.import('js/game.js').then(function(game) {
			var spikeImpact = game.default
			spikeImpact.onGameOver = function() {
				var gameOverDiv = document.querySelector('#viewport .gameover')

				if (localStorage) {
					var highScore = localStorage.getItem('spikeImpactHighScore') |0
					if (highScore < spikeImpact.score.count) {
						highScore = spikeImpact.score.count
						localStorage.setItem('spikeImpactHighScore', highScore)
						gameOverDiv.innerHTML += '<br/>New HiScore: ' + highScore
					}
				}

				var canvasStyle = document.querySelector('#viewport canvas').style
				canvasStyle.webkitFilter = canvasStyle.filter = 'grayscale(.5)'

				var gameOverStyle = gameOverDiv.style
				gameOverStyle.height = canvasStyle.height
				gameOverStyle.fontSize = parseInt(canvasStyle.height) / 6 + 'px'
				gameOverStyle.display = 'block'
			}

			System.import('js/virtkb.js').then(function(virtkb) {
				spikeImpact.game.device.whenReady(function() {
					virtkb.default(spikeImpact.game)
				})
			})
		})
	</script>
</head>
<body>
	<div id="viewport"><span class="loader">Грузиццо</span><div class="gameover">GAME OVER</div></div>
	<div id="touchKeys">
		<div class="left block">
			<div class="up">8</div>
			<div class="down">0</div>
			<div class="bonus">6</div>
		</div>
		<div class="right block">
			<div class="left">*</div>
			<div class="right">#</div>
			<div class="shoot">3</div>
		</div>
	</div>
</body>
</html>
